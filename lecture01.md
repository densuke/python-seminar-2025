---
marp: true
theme: style
size: 16:9
paginate: true
---
<script type="module"> <!-- Mermaidは常に使うわけでは無いので削除してもよいが、後のスライドで使うので残しておく -->
import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.esm.min.mjs';
mermaid.initialize({ startOnLoad: true });
</script>

# Pythonセミナー 第1回

## Pythonの環境管理とuvツール

---

## この時間に学ぶこと

- なぜPythonの環境管理が重要なのかを知る
- 様々な環境管理ツールの存在を理解する
- **`uv`** というモダンなツールを使って、プロジェクトの環境を構築できるようになる
- VS Codeと`uv`を連携させて、快適な開発環境を整える

---

## なぜ環境管理が必要なの？

プロジェクトAではライブラリXのバージョン1.0が必要
プロジェクトBではライブラリXのバージョン2.0が必要

→ 一つのPCに両方のバージョンをそのまま入れると、衝突してしまいます！

**プロジェクトごとに独立した「部屋」を用意して、必要な道具（ライブラリ）を揃えるのが「環境管理」です。**

---

## いろいろな管理ツール

Pythonには、環境管理のツールがいくつかあります。

* `venv`: 標準で付属する基本的な仮想環境ツール
* `pip`: パッケージ（ライブラリ）を操作する標準ツール
* `Poetry`, `Pipenv`: 仮想環境とパッケージ管理を一緒に行う高機能ツール
* `pyenv`: 複数のPythonバージョン自体を切替えるツール

それぞれに長所がありますが、覚えることが少し多いのが難点でした。

---

## 今日の主役: `uv`

`uv` は、最近登場した **非常に高速** なPythonパッケージ管理ツールです。

- `venv`のような仮想環境作成
- `pip`のようなパッケージインストール
- `Poetry`のような依存関係解決

これらの機能を **一つのコマンド (`uv`)** で、しかも **圧倒的な速さ** で実行できます。
今日はこの`uv`を使って、モダンなPython開発環境を体験してみましょう！

---

## 演習1: `uv`の準備

`uv`は単一の実行ファイルなので、インストールも簡単です。
(※ 事前にPCにインストールされていることを想定)

まず、ターミナルを開いて、`uv`が使えるか確認しましょう。

```powershell
uv --version
```

バージョン番号が表示されればOKです。

---

## 演習2: プロジェクトの初期化

1.  まず、セミナー用の作業ディレクトリを作成します。
    今回はこの資料を配付しているリポジトリのトップをそのまま使います。ターミナルを開いて以下を実行してください。
    ```powershell
    uv init .
    ```

2.  次に、`uv`でPythonの仮想環境を作成します。
    ```powershell
    uv venv
    ```
    これで、`.venv` という名前の「部屋」が作られました。

---

## 演習3: VS Codeとの連携

1.  VS Codeのエクスプローラーでmain.pyを探し、開いてください(自動生成)
2.  `main.py` というファイルを作成してみましょう。
3.  VS Codeの右下にPythonのバージョンが表示されている部分をクリックします。
    (もしくは `Ctrl+Shift+P` で「Python: Select Interpreter」を選択)
4.  リストから **「.venv」** と書かれているインタプリタを選択します。

これで、VS Codeがプロジェクト専用のPython環境を見るようになります。

---

## 演習4: パッケージの追加

`uv add` コマンドで、必要なライブラリをインストールします。
試しに、Webフレームワークの `bottle` を入れてみましょう。

```powershell
uv add bottle
```

`pyproject.toml` というファイルが自動で作成・更新され、インストールしたパッケージが記録されます。

---

## 余談: `pyproject.toml`って?

`pyproject.toml` は、Pythonプロジェクトの設定ファイルです。

- どのパッケージが必要か
- どのPythonバージョンを使うか
- どのツールを使うか

などの情報をまとめて管理できます。
これにより、プロジェクトの再現性が高まり、他の人との共有が簡単になります。

---

## 余談: バージョン固定の真実

バージョン固定は、ファイル .python-version に記録されます。

- バージョンの上限・下限は `pyproject.toml` に記録されます。
- 自動的にその範囲内で最新の入手できるものが選定されます
- 例えば、`3.13` と指定すると、3.13.x の最新バージョンが使われます。
- 実際に使用しているものが `.python-version` に記録されます。
---

## 演習5: Pythonバージョンの固定

このプロジェクトで使うPythonのバージョンを固定しておきましょう。
今回は `3.13` を使います。

```powershell
uv python pin 3.13
```

これで、他の人がこのプロジェクトを使うときも、同じPythonバージョンで環境を再現できます。

---

## 演習6: モジュールの依存関係

モジュールは依存関係を持つことがあります。そのため追加・削除時に必要なものが追加・削除されます(関係が壊れない範囲で)。
pandas(データ分析でよく使われます)で確認してみます。

```powershell
uv add pandas       # pandasを追加する
uv pip list         # 依存関係が表示される(pandasだけではない)
uv remove pandas    # pandasを削除する
uv pip list         # 依存関係が削除される(ひととおり消えることに注目)
```

見ての通り、依存関係を見て自動的に必要なものを追加・削除してくれます(なおこの速度が爆速とされることも`uv`の特徴です)。

---

## 1時間目のまとめ

- プロジェクトごとに環境を分けることの重要性を学んだ
- `uv`という高速なツールを知った
- `uv venv`で仮想環境を作成した
- `uv add`でパッケージをインストールした
- `uv python pin`でPythonのバージョンを固定した
- VS Codeで作成した仮想環境を認識させた

これで、モダンなPython開発の第一歩は完了です！

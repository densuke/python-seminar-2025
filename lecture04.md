---
marp: true
theme: style
size: 16:9
paginate: true
---

# Pythonセミナー 第4回

## 型ヒントと関数設計

---

## この時間に学ぶこと

- なぜ関数を小さく分割するべきなのかを理解する
- 「単一責任の原則」を関数設計に応用する
- Pythonの型ヒントの基本的な書き方を習得する
- `typing`モジュールを使い、より複雑な型を表現する方法を学ぶ

---

## なぜ関数を分割するのか？

一つの関数にたくさんの処理を詰め込むと…

- **読みにくい**: 何をしているのか理解するのが難しい
- **テストしにくい**: 特定のロジックだけをテストするのが困難
- **再利用しにくい**: 一部の機能だけを使いたい、ということができない
- **修正が怖い**: 一つの変更が、予期せぬ場所に影響を与える（バグの温床）

---

## 単一責任の原則<br/>(Single Responsibility Principle)

> 一つの関数（やクラス）は、一つの、そして唯一の責任だけを持つべきである

- **「ユーザーのデータを読み込む」**
- **「読み込んだデータを処理する」**
- **「処理結果を表示する」**

このように、役割ごとに処理を関数として切り分けることで、プログラムの見通しが良くなり、メンテナンス性が向上します。

---

## 余談: UNIXの哲学

* 『小さなツールで、特定のタスクを実行する』
  * 関数それぞれは小さく、特定の役割に集中させる
* 『パイプラインで、ツールを組み合わせる』
  * 関数同士を繋げて目的へと導く
* 『シンプルであることが美しい』
  * ごちゃごちゃ書くな

---

## 型ヒント (Type Hints) とは？

Pythonの変数や関数の引数、戻り値に「このデータはこういう型（整数、文字列など）ですよ」というヒントを付ける機能です。

- コードの可読性が向上する（何を受け取り、何を返すかが一目瞭然）
- エディタ（VS Codeなど）が強力な入力補完やエラーチェックをしてくれる
- `mypy`などの静的解析ツールで、実行前にバグを発見できる

**注意:** 型ヒントはあくまで「ヒント」。実行時の動作を強制するものではありません。

---

## 型ヒントの基本的な書き方

**コード例: `04/type_hints_basic.py`**

```python
# 変数の型ヒント
user_name: str = "Alice"
user_age: int = 30

# 関数の引数と戻り値の型ヒント
def greet(name: str, age: int) -> str:
    # ...
    pass
```

---

## VS CodeとPylanceによる型チェック

VS CodeにPython拡張機能（Pylance）を導入していると、型ヒントの恩恵を最大限に受けられます。
**リアルタイムなエラー指摘** および **強力な補完機能**: 型情報に基づいて、より正確なコード補完を提供します。

**コード例: `04/pylance_example.py`**

```python
def add_numbers(a: int, b: int) -> int:
    return a + b

result = add_numbers(10, 20) # ここを"20"にしてみよう!
```

---

## `typing`モジュールの活用

単純な型（`int`, `str`など）だけでは表現できない、より複雑なデータ構造のために`typing`モジュールが用意されています。

- `List[T]`: T型の要素を持つリスト
- `Dict[K, V]`: キーがK型、値がV型の辞書
- `Tuple[T1, T2, ...]`: 要素の型が固定されたタプル
- `Optional[T]`: T型、もしくは `None`
- `Union[T1, T2]`: T1型またはT2型

---

## `typing`モジュールの使用例

**コード例: `04/typing_module_example.py`**

```python
from typing import List, Dict, Optional

# 文字列のリストを受け取る関数
def process_names(names: List[str]) -> None:
    # ...
    pass

# ユーザー情報を辞書で受け取る関数
def get_user_info(user_id: int) -> Optional[Dict[str, str]]:
    # ...
    pass
```

---

## 4時間目のまとめ

- 関数は「単一責任の原則」を意識して、小さく分割することが重要
- 型ヒントは、コードの可読性と安全性を高めるための強力なツール
- 基本的な型は `: 型` のように記述する
- `List`や`Dict`など、複雑な型を表現するには`typing`モジュールを利用する
- 型ヒントを付けることで、エディタのサポートを最大限に活用できる
